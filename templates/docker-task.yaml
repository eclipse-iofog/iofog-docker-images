parameters:
  platform: ''
  target: ''

steps:
  - task: Docker@2
    displayName: 'Build and Push ${{ parameters.target }} for ${{ parameters.platform }}'
    inputs:
      containerRegistry: 'Edgeworx GCP'
      repository: '$(repository)/${{ parameters.target }}'
      command: 'buildAndPush'
      Dockerfile: '${{ parameters.target }}/Dockerfile.${{ parameters.platform }}'
      buildContext: '.'
      tags: |
        latest
        ${{ parameters.platform }}
