parameters:
  platform: ''
  target: ''
  version: ''

steps:
  - task: Docker@2
    displayName: 'Build and Push ${{ parameters.target }} ${{ parameters.version }} for ${{ parameters.platform }}'
    inputs:
      containerRegistry: 'Edgeworx GCP'
      repository: '$(repository)/${{ parameters.target }}-${{ parameters.platform }}'
      command: 'buildAndPush'
      Dockerfile: '${{ parameters.target }}-${{ parameters.version }}/Dockerfile.${{ parameters.platform }}'
      buildContext: '.'
      tags: |
        ${{ parameters.version }}
